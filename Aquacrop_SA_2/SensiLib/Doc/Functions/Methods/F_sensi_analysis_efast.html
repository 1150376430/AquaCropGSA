<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description de F_sensi_analysis_efast</title>
  <meta name="keywords" content="F_sensi_analysis_efast">
  <meta name="description" content="Calcul des indices se sensibilite avec la methode FAST.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- menu.html Methods -->
<h1>F_sensi_analysis_efast
</h1>

<h2><a name="_name"></a>BUT <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Calcul des indices se sensibilite avec la methode FAST.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [v_S,v_ST]=F_sensi_analysis_efast(vs_method_options,v_out_mat) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Calcul des indices se sensibilite avec la methode FAST.

 Cette fonction sert a calculer les indices de sensibilite principaux de 
 1er ordre et les indices de sensibilite totaux selon la methode Extended 
 Fast. Cette methode est decrite en detail dans le document 
 &quot;La methode FAST et ses extensions&quot; qui servira de reference dans les 
 commentaires suivants (notamment pour les formules utilisees).

 ENTREES :

      - vs_method_options : structure de definition des options de la
        methode
          o vs_method_options.NsIni : scalaire entier contenant la taille de
            l'echantillon souhaitee par l'utilisateur. Cette taille doit 
            etre superieure ou egale a 65.
            Le calcul des frequences a partir de Ns impose que 
            (Ns-1) soit un multiple de (2*M)^2). Si tel n'est pas le
            cas pour NsIni, on prendra le plus grand no inferieur a 
            NsIni qui satisfait cette condition. 
            La taille reelle de l'echantillon sera donc :
             v_Ns=(NsIni-mod(NsIni-1,(2*M)^2));
            Le nombre total de simulations a realiser pour calculer les
            indices sera alors de v_C=v_Ns*(Nb+1)*Nrep, ou Nb est 
            le nombre de parametres variant.
          o vs_method_options.Nrep (OPTIONNEL) : scalaire entier contenant le no de re-echantillonage ou de 
            replicat i.e. le no de fois que les indices doivent etre 
            calcules de facon independante (no de tirages aleatoires du 
            shift phi). 
            Vaut 1 par defaut. 
          o vs_method_options.M (OPTIONNEL) : nombre maximal d'harmonique
            pris en compte dans la methode.
            Vaut 4 par defaut.
        ATTENTION : les valeurs de ces options doivent etre identiques a
        celles donnees en argument de F_gen_variant_efast.

       - v_out_mat : 
          matrice de type flottant de taille : 
             no de simulations * no de variables
          contenant les valeurs des sorties du modeles correspondant aux 
          variants generes par F_gen_variant_efast. 


 SORTIE :
       - v_S : 
          tableau de type flottant de taille 
            Nrep * no de parametres * no de variables de sortie, 
          contenant les differents replicats des indices principaux de 
          1er ordre calcules pour les differentes variables de sortie par 
          rapport aux differents parametres variants. 

       - v_ST : 
          tableau de type flottant de taille 
            Nrep * no de parametres * no de variables de sortie, 
          contenant les differents replicats des indices totaux calcules 
          pour les differentes variables de sortie par rapport aux 
          differents parametres variants.

       ATTENTION : si l'option &quot;parametre dummy&quot; a ete choisie dans
       F_gen_variant_efast, v_S(:,no de parametres+1,:) et v_ST(:,no de
       parametres+1,:) contiendront les indices calcules pour ce
       parametre. 
       Les valeurs de v_S(:,no de parametres+1,:) devraient etre 
       negligeables. Si ce n'est pas le cas, recommencer l'analyse avec une 
       taille d'echantillon superieure. Les indices principaux des parametres 
       qui ont une valeur inferieure a celles des indices principaux du
       parametre dummy, doivent etre consideres comme negligeables.
       Les valeurs de v_ST(:,no de parametres+1,:) donnent les 
       parts de variance qui ne peuvent pas etre affectees aux variations 
       des parametres. Cette part devrait etre retiree des indices totaux
       des autres parametres.

 CONTENU :
        On commence par calculer la taille de l'echantillon, les
        variations de s et la liste de frequence, comme dans
        F_gen_variant_efast.
        Puis, pour chaque variable consideree, pour chaque replicats, et 
        chaque facteur :
              - mise a jour de la liste des frequences (la frequence 
                maximum est affectee au parametre pour lequel on calcule 
                les effets, les frequences des autres parametres etant 
                issue de la liste de frequence calculee au debut) ;
              - calcul de la transformee de Fourier et des coeff. de
                Fourier ;
              - calcul des variances totales et partielles ;
              - calcul des indices totaux et principaux.
        Le calcul des indices est detaille dans la documentation associee.        

 AUTEUR : S. BUIS ET H.V VARELLA 
         (merci a J.Jacques et C.Naud pour leurs contributions)
 DATE : 04-mai-2007
 VERSION : 0
  
  MODIFICATIONS (last commit)
    $Date: 2013-06-19 14:49:50 +0200 (mer., 19 juin 2013) $
    $Author: plecharpent $
    $Revision: 40 $
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definition du tableau contenant les options de la methode</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>INFORMATION SUR LES REFERENCES CROISEES <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
Cette fonction fait appel à:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
Cette fonction est appelée par:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>CODE SOURCE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [v_S,v_ST]=F_sensi_analysis_efast(vs_method_options,v_out_mat)</a>
0002 <span class="comment">% Calcul des indices se sensibilite avec la methode FAST.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Cette fonction sert a calculer les indices de sensibilite principaux de</span>
0005 <span class="comment">% 1er ordre et les indices de sensibilite totaux selon la methode Extended</span>
0006 <span class="comment">% Fast. Cette methode est decrite en detail dans le document</span>
0007 <span class="comment">% &quot;La methode FAST et ses extensions&quot; qui servira de reference dans les</span>
0008 <span class="comment">% commentaires suivants (notamment pour les formules utilisees).</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% ENTREES :</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%      - vs_method_options : structure de definition des options de la</span>
0013 <span class="comment">%        methode</span>
0014 <span class="comment">%          o vs_method_options.NsIni : scalaire entier contenant la taille de</span>
0015 <span class="comment">%            l'echantillon souhaitee par l'utilisateur. Cette taille doit</span>
0016 <span class="comment">%            etre superieure ou egale a 65.</span>
0017 <span class="comment">%            Le calcul des frequences a partir de Ns impose que</span>
0018 <span class="comment">%            (Ns-1) soit un multiple de (2*M)^2). Si tel n'est pas le</span>
0019 <span class="comment">%            cas pour NsIni, on prendra le plus grand no inferieur a</span>
0020 <span class="comment">%            NsIni qui satisfait cette condition.</span>
0021 <span class="comment">%            La taille reelle de l'echantillon sera donc :</span>
0022 <span class="comment">%             v_Ns=(NsIni-mod(NsIni-1,(2*M)^2));</span>
0023 <span class="comment">%            Le nombre total de simulations a realiser pour calculer les</span>
0024 <span class="comment">%            indices sera alors de v_C=v_Ns*(Nb+1)*Nrep, ou Nb est</span>
0025 <span class="comment">%            le nombre de parametres variant.</span>
0026 <span class="comment">%          o vs_method_options.Nrep (OPTIONNEL) : scalaire entier contenant le no de re-echantillonage ou de</span>
0027 <span class="comment">%            replicat i.e. le no de fois que les indices doivent etre</span>
0028 <span class="comment">%            calcules de facon independante (no de tirages aleatoires du</span>
0029 <span class="comment">%            shift phi).</span>
0030 <span class="comment">%            Vaut 1 par defaut.</span>
0031 <span class="comment">%          o vs_method_options.M (OPTIONNEL) : nombre maximal d'harmonique</span>
0032 <span class="comment">%            pris en compte dans la methode.</span>
0033 <span class="comment">%            Vaut 4 par defaut.</span>
0034 <span class="comment">%        ATTENTION : les valeurs de ces options doivent etre identiques a</span>
0035 <span class="comment">%        celles donnees en argument de F_gen_variant_efast.</span>
0036 <span class="comment">%</span>
0037 <span class="comment">%       - v_out_mat :</span>
0038 <span class="comment">%          matrice de type flottant de taille :</span>
0039 <span class="comment">%             no de simulations * no de variables</span>
0040 <span class="comment">%          contenant les valeurs des sorties du modeles correspondant aux</span>
0041 <span class="comment">%          variants generes par F_gen_variant_efast.</span>
0042 <span class="comment">%</span>
0043 <span class="comment">%</span>
0044 <span class="comment">% SORTIE :</span>
0045 <span class="comment">%       - v_S :</span>
0046 <span class="comment">%          tableau de type flottant de taille</span>
0047 <span class="comment">%            Nrep * no de parametres * no de variables de sortie,</span>
0048 <span class="comment">%          contenant les differents replicats des indices principaux de</span>
0049 <span class="comment">%          1er ordre calcules pour les differentes variables de sortie par</span>
0050 <span class="comment">%          rapport aux differents parametres variants.</span>
0051 <span class="comment">%</span>
0052 <span class="comment">%       - v_ST :</span>
0053 <span class="comment">%          tableau de type flottant de taille</span>
0054 <span class="comment">%            Nrep * no de parametres * no de variables de sortie,</span>
0055 <span class="comment">%          contenant les differents replicats des indices totaux calcules</span>
0056 <span class="comment">%          pour les differentes variables de sortie par rapport aux</span>
0057 <span class="comment">%          differents parametres variants.</span>
0058 <span class="comment">%</span>
0059 <span class="comment">%       ATTENTION : si l'option &quot;parametre dummy&quot; a ete choisie dans</span>
0060 <span class="comment">%       F_gen_variant_efast, v_S(:,no de parametres+1,:) et v_ST(:,no de</span>
0061 <span class="comment">%       parametres+1,:) contiendront les indices calcules pour ce</span>
0062 <span class="comment">%       parametre.</span>
0063 <span class="comment">%       Les valeurs de v_S(:,no de parametres+1,:) devraient etre</span>
0064 <span class="comment">%       negligeables. Si ce n'est pas le cas, recommencer l'analyse avec une</span>
0065 <span class="comment">%       taille d'echantillon superieure. Les indices principaux des parametres</span>
0066 <span class="comment">%       qui ont une valeur inferieure a celles des indices principaux du</span>
0067 <span class="comment">%       parametre dummy, doivent etre consideres comme negligeables.</span>
0068 <span class="comment">%       Les valeurs de v_ST(:,no de parametres+1,:) donnent les</span>
0069 <span class="comment">%       parts de variance qui ne peuvent pas etre affectees aux variations</span>
0070 <span class="comment">%       des parametres. Cette part devrait etre retiree des indices totaux</span>
0071 <span class="comment">%       des autres parametres.</span>
0072 <span class="comment">%</span>
0073 <span class="comment">% CONTENU :</span>
0074 <span class="comment">%        On commence par calculer la taille de l'echantillon, les</span>
0075 <span class="comment">%        variations de s et la liste de frequence, comme dans</span>
0076 <span class="comment">%        F_gen_variant_efast.</span>
0077 <span class="comment">%        Puis, pour chaque variable consideree, pour chaque replicats, et</span>
0078 <span class="comment">%        chaque facteur :</span>
0079 <span class="comment">%              - mise a jour de la liste des frequences (la frequence</span>
0080 <span class="comment">%                maximum est affectee au parametre pour lequel on calcule</span>
0081 <span class="comment">%                les effets, les frequences des autres parametres etant</span>
0082 <span class="comment">%                issue de la liste de frequence calculee au debut) ;</span>
0083 <span class="comment">%              - calcul de la transformee de Fourier et des coeff. de</span>
0084 <span class="comment">%                Fourier ;</span>
0085 <span class="comment">%              - calcul des variances totales et partielles ;</span>
0086 <span class="comment">%              - calcul des indices totaux et principaux.</span>
0087 <span class="comment">%        Le calcul des indices est detaille dans la documentation associee.</span>
0088 <span class="comment">%</span>
0089 <span class="comment">% AUTEUR : S. BUIS ET H.V VARELLA</span>
0090 <span class="comment">%         (merci a J.Jacques et C.Naud pour leurs contributions)</span>
0091 <span class="comment">% DATE : 04-mai-2007</span>
0092 <span class="comment">% VERSION : 0</span>
0093 <span class="comment">%</span>
0094 <span class="comment">%  MODIFICATIONS (last commit)</span>
0095 <span class="comment">%    $Date: 2013-06-19 14:49:50 +0200 (mer., 19 juin 2013) $</span>
0096 <span class="comment">%    $Author: plecharpent $</span>
0097 <span class="comment">%    $Revision: 40 $</span>
0098 <span class="comment">%</span>
0099 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0100 <span class="comment">%% Definition du tableau contenant les options de la methode</span>
0101 vc_options_desc=struct(<span class="string">'name'</span>,{<span class="string">'NsIni'</span>,<span class="string">'Nrep'</span>,<span class="string">'M'</span>},<span class="keyword">...</span>
0102     <span class="string">'datatype'</span>,{<span class="string">'uint32'</span>,<span class="string">'uint32'</span>,<span class="string">'uint32'</span>},<span class="keyword">...</span>
0103     <span class="string">'status'</span>,{<span class="string">'non optional'</span>,<span class="string">'optional'</span>,<span class="string">'optional'</span>},<span class="keyword">...</span>
0104     <span class="string">'defaultvalue'</span>,{[],1,4},<span class="keyword">...</span>
0105     <span class="string">'comments'</span>,{<span class="string">'Taille de l''echantillon souhaitee par l''utilisateur'</span>, <span class="keyword">...</span>
0106                 <span class="string">'Nombre de replicat de la methode'</span>,<span class="keyword">...</span>
0107                 <span class="string">'Nombre maximal d''harmoniques prises en compte'</span>});
0108 
0109 <span class="comment">%% Retour de la structure pour verification si appel sans arguments</span>
0110 <span class="keyword">if</span> nargin==0
0111     v_S=vc_options_desc;
0112     <span class="keyword">return</span>
0113 <span class="keyword">end</span>
0114 
0115 <span class="comment">%% Renseignement des options par defaut</span>
0116 <span class="keyword">for</span> i=1:length(vc_options_desc)
0117     <span class="keyword">if</span> ~isfield(vs_method_options,vc_options_desc(i).name)
0118         <span class="keyword">if</span> strmatch(<span class="string">'optional'</span>,vc_options_desc(i).status,<span class="string">'exact'</span>)
0119             vs_method_options.(vc_options_desc(i).name)=vc_options_desc(i).defaultvalue;
0120         <span class="keyword">else</span>
0121             error([<span class="string">'L''option '</span> vc_options_desc(i).name <span class="string">' doit etre renseignee.'</span>])
0122         <span class="keyword">end</span>
0123     <span class="keyword">end</span>
0124 <span class="keyword">end</span>
0125 
0126 <span class="comment">%% Tests divers sur les arguments</span>
0127 v_Nrep=vs_method_options.Nrep;
0128 v_M=vs_method_options.M;
0129 v_Ns_ini=vs_method_options.NsIni;
0130 
0131 <span class="comment">% Calcul de la taille de l'echantillon pour le calcul des effets totaux</span>
0132 <span class="comment">% v_Ns-1 doit etre un multiple de (2*v_M)^2 pour la definition</span>
0133 <span class="comment">% des frequences (formules (28) et (30)).</span>
0134 v_Ns=(v_Ns_ini-mod(v_Ns_ini-1,(2*v_M)^2));
0135 
0136 <span class="comment">% Initialisation</span>
0137 v_C=size(v_out_mat,1);
0138 v_n=v_C/(v_Ns*v_Nrep);
0139 <span class="keyword">if</span> v_n&lt;=1
0140     v_out_mat=v_out_mat';
0141     v_C=size(v_out_mat,1);
0142     v_n=v_C/(v_Ns*v_Nrep);    
0143     <span class="keyword">if</span> v_n&lt;=1
0144         error([<span class="string">'L''argument v_out_mat n''a pas la taille attendu.'</span>])
0145     <span class="keyword">end</span>
0146 <span class="keyword">end</span>
0147 v_nb_var=size(v_out_mat,2);
0148 
0149 v_S=zeros(v_Nrep,v_n,v_nb_var);
0150 v_ST=zeros(v_Nrep,v_n,v_nb_var);
0151 
0152 <span class="comment">% Calcul de la frequence maximale et de la liste de frequence</span>
0153 <span class="comment">% a partir de la taille de l'echantillon selon l'algorithme presente</span>
0154 <span class="comment">% section IV.3</span>
0155 v_wmax=(v_Ns-1)/(2*v_M);
0156 
0157 <span class="comment">% Boucle sur le no de variables de sorties a analyser</span>
0158 <span class="keyword">for</span> ivar=1:v_nb_var
0159 
0160     v_indmin=1;
0161     
0162     <span class="comment">% Boucle sur l'aleas du shift phi</span>
0163     <span class="keyword">for</span> i=1:v_Nrep
0164        
0165         <span class="comment">% Boucle sur le no de facteurs</span>
0166         <span class="keyword">for</span> j=1:v_n
0167 
0168             <span class="comment">% Calcul de la transformee de Fourier. On n'utilise pas les</span>
0169             <span class="comment">% formules definies en (21) pour le calcul des coef. de Fourier</span>
0170             <span class="comment">% Aj et Bj, mais la fonction fft2 de matlab qui permet de</span>
0171             <span class="comment">% calculer ces quantites de facon beaucoup plus efficace.</span>
0172             v_indmax=v_indmin+v_Ns-1;
0173             v_F=fft2(v_out_mat(v_indmin:v_indmax,ivar));
0174             v_indmin=v_indmax+1;
0175 
0176             <span class="comment">% Calcul des coefficients de Fourier</span>
0177             v_kmax=((v_Ns)-1)/2;
0178             <span class="keyword">for</span> k=1:v_kmax
0179                 v_a(k)=real(v_F(k+1))/v_Ns;
0180                 v_b(k)=imag(v_F(k+1))/v_Ns;
0181             <span class="keyword">end</span>
0182 
0183             <span class="comment">% Calcul du spectre de v_F de 1 a (Ns-1)/2</span>
0184             v_Spectre=v_a.^2+v_b.^2;
0185             
0186             <span class="comment">% Calcul de la variance totale (formule (22)).</span>
0187             v_D=2*sum(v_Spectre);
0188 
0189             <span class="comment">% Calcul de la variance expliquee par le facteur j (formule</span>
0190             <span class="comment">% (23))</span>
0191             v_Di=2*sum(v_Spectre(v_wmax:v_wmax:v_M*v_wmax));
0192 
0193             <span class="comment">% Calcul de la variance expliquee par les facteurs</span>
0194             <span class="comment">% complementaires (formule (18))</span>
0195             v_Dmi=2*sum(v_Spectre(1:v_wmax/2));
0196            
0197             <span class="comment">% Calcul des indices totaux et principaux</span>
0198             <span class="keyword">if</span> abs(v_D)&lt;=eps(0.)
0199                 v_ST(i,j,ivar)=0;
0200                 v_S(i,j,ivar)=0;
0201             <span class="keyword">else</span>
0202                 v_ST(i,j,ivar)=1-v_Dmi/v_D;
0203                 v_S(i,j,ivar)=v_Di/v_D;
0204             <span class="keyword">end</span>
0205         <span class="keyword">end</span>
0206       
0207     
0208     <span class="keyword">end</span>
0209         
0210 <span class="keyword">end</span></pre></div>
<hr><address>Généré le Tue 18-Mar-2014 17:21:41 par <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>
# AquaCrop敏感性分析系统

## 一、系统概述

### 1.1 功能简介
- 基于AquaCrop模型的敏感性分析系统
- 使用Morris和EFAST方法分析模型参数敏感性
- 支持作物生长、水分利用和产量分析

### 1.2 系统特点
- 双重分析方法：Morris筛选 + EFAST定量分析
- 完整的参数敏感性评估
- 可视化结果展示

## 二、系统结构

### 2.1 目录结构
```
AquaCrop_SA/
├── AquaCropFolder64bit/     # AquaCrop主程序
│   ├── DATA/                # 模型数据
│   ├── SIMUL/              # 模拟数据
│   └── OUTP/               # 输出数据
├── Structure/              # 配置文件
├── Results/               # 分析结果
└── SensiLib/             # 分析工具库
```

### 2.2 核心文件说明
1. 主程序文件
   - `run_sensitivity_analysis.m`: 主程序入口
   - `F_AS_Aquacrop.m`: AquaCrop接口
   - `Morris_method.m`: Morris分析实现
   - `EFAST_method.m`: EFAST分析实现

2. 配置文件
   - `AC_fileinput_ref.mat`: 基本配置
   - `AC_Param_ref.mat`: 参数配置

## 三、输入数据要求

### 3.1 必需输入文件
1. 气象数据（`SIMUL/`目录）
   - `TempData.SIM`: 温度数据
   - `RainData.SIM`: 降水数据
   - `EToData.SIM`: 蒸散发数据
   - `MaunaLoa.CO2`: CO2数据

2. 模型参数（`DATA/`目录）
   - `Soil_*.SOL`: 土壤参数
   - `Crop_*.CRO`: 作物参数

### 3.2 数据格式规范

#### 气象数据格式
1. TempData.SIM
```
年 月 日 最高温度 最低温度
2020 1 1 15.5 5.2
```

2. RainData.SIM
```
年 月 日 降雨量(mm)
2020 1 1 0.0
```

3. EToData.SIM
```
年 月 日 参考蒸散量(mm)
2020 1 1 2.5
```

## 四、参数说明

### 4.1 作物生长参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| CGC | 冠层生长系数 | %/GDD | 0.01-0.60 | 描述冠层生长速率 |
| CDC | 冠层衰减系数 | %/GDD | 0.05-0.15 | 描述冠层衰减速率 |
| CCx | 最大冠层覆盖度 | % | 80-99 | 最大覆盖度 |
| CCo | 初始冠层覆盖度 | % | 3-9 | 出苗时覆盖度 |
| WP* | 标准化水分生产力 | g/m² | 16-48 | 生物量水分效率 |
| Emergence | 出苗所需积温 | GDD | 30-90 | 出苗温度要求 |
| Senescence | 衰老开始积温 | GDD | 1360-3000 | 衰老起始温度 |
| Maturity | 成熟所需积温 | GDD | 1400-3000 | 完熟温度要求 |
| HIo | 参考收获指数 | % | 25-75 | 产量与生物量比 |
| den | 种植密度 | 株/ha | 90000-300000 | 每公顷株数 |

### 4.2 水分胁迫参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| p_up | 上限胁迫阈值 | - | 0.2-0.4 | 气孔导度阈值 |
| p_lo | 下限胁迫阈值 | - | 0.4-0.7 | 叶片衰老阈值 |
| psto | 气孔关闭阈值 | - | 0.2-0.75 | 气孔响应阈值 |
| psen | 衰老阈值 | - | 0.8-1.0 | 衰老启动阈值 |
| ppol | 授粉胁迫阈值 | - | 0.2-0.99 | 授粉影响阈值 |
| anaer | 厌氧胁迫系数 | - | 1-8 | 渍水影响系数 |

### 4.3 土壤水分参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| th_fc | 田间持水量 | cm³/cm³ | 28-42 | 土壤持水能力 |
| th_wp | 永久萎蔫点 | cm³/cm³ | 7-15 | 最低含水量 |
| Ksat | 饱和导水率 | mm/天 | 120-360 | 水分传导能力 |
| REW | 易蒸发水 | mm | 5-13 | 表层易蒸发水 |
| TEW | 总可蒸发水 | mm | 20-50 | 总可蒸发水量 |
| fk | 蒸发衰减系数 | - | 2-6 | 蒸发衰减率 |

### 4.4 根系参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| rtmin | 最小根深 | m | 0.15-0.45 | 初始根深 |
| rtx | 最大根深 | m | 0.6-1.8 | 最大根系深度 |
| rtexup | 上层吸水系数 | /天 | 0.01-0.03 | 表层吸水能力 |
| rtxlw | 下层吸水系数 | /天 | 0.0025-0.0075 | 深层吸水能力 |
| root | 根系生长期 | GDD | 256-768 | 根系生长周期 |

### 4.5 温度参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| To_crop | 基本温度 | °C | -5-5 | 生长最低温度 |
| Tmax_crop | 上限温度 | °C | 25-35 | 生长最高温度 |
| polmn | 授粉最低温 | °C | 5-12 | 授粉最低温度 |
| polmx | 授粉最高温 | °C | 35-45 | 授粉最高温度 |

### 4.6 其他参数
| 参数代码 | 含义 | 单位 | 范围 | 说明 |
|---------|------|------|------|------|
| exc | 过量生长衰减 | % | 50-150 | 过度生长影响 |
| hipsflo | 开花期HI调整 | % | 5-15 | 开花期收获指数调整 |
| hipsveg | 营养生长HI调整 | % | 5-15 | 营养生长期收获指数调整 |
| hingsto | 气孔HI调整 | % | 5-15 | 气孔影响收获指数调整 |
| hinc | HI增量 | % | 5-15 | 收获指数最大增量 |

## 五、运行说明

### 5.1 运行步骤
1. 准备输入数据
2. 运行主程序：`run_sensitivity_analysis`
3. 选择分析方法：
   - 1 = EFAST方法
   - 2 = Morris方法

### 5.2 参数设置
1. Morris方法参数
```matlab
options.p = 8;    % 网格级别
options.r = 10;   % 轨迹数
options.n = 1;    % 步长
```

2. EFAST方法参数
```matlab
options.NsIni = 1250;  % 样本数
options.Nrep = 5;      % 重复次数
```

## 六、结果分析

### 6.1 结果文件
1. EFAST结果
   - `EFAST_results_*.mat`
   - 包含主效应(Si)和总效应(STi)

2. Morris结果
   - `Morris_results_*.mat`
   - 包含μ*和σ值

### 6.2 结果解读
1. EFAST指标
   - Si: 单参数直接影响
   - STi: 参数总体影响

2. Morris指标
   - μ*: 参数总体重要性
   - σ: 参数非线性/交互作用

## 七、注意事项

### 7.1 数据准备
1. 文件命名必须准确
2. 数据格式需符合要求
3. 保持目录结构完整

### 7.2 运行注意
1. 检查参数范围设置
2. 确保数据完整性
3. 注意结果保存路径

## 八、常见问题

### 8.1 运行问题
1. 找不到气象数据
   - 检查文件名和路径
   - 确认数据格式

2. 参数设置问题
   - 检查范围合理性
   - 确认单位正确

### 8.2 结果问题
1. 结果不收敛
   - 增加样本数量
   - 检查参数范围

2. 敏感性异常
   - 检查参数相关性
   - 验证数据质量
